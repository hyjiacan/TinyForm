!function(e,t){"use strict";function r(){return"tiny"+(new Date).getTime()+Math.random().toString().substring(2)}function n(t,i){var a=e(t).first(),s=a.attr(o);return s&&l.hasOwnProperty(s)||(s=r(),a.attr(o,s),l[s]=new n.prototype.setup(a,i,s)),l[s]}function i(t){var r=c[t.id]={};t.context.find(t.option.selector).each(function(){var t=e.trim(e(this).attr("name"));if(""!==t)return"undefined"==typeof r[t]||0===r[t].length?void(r[t]=e(this)):e(this).is("[type=radio]")?void r[t].push(this):void console.error('控件的name属性"'+t+'"出现多次，这不对吧')})}var a="input[name]:not([type=button][type=submit][type=reset]), select[name], textarea[name]",o="data-tinyform",s="插件添加方法失败: 此方法已经存在",u={setup:[],refresh:[]},l={},c={};n.prototype={constructor:n,setup:function(t,r,n){var o=this;return o.id=n,o.option=e.extend(!0,{selector:a},r),o.context=t,i(o),e.each(u.setup,function(){this.call(o)}),o},getField:function(t){var r=e.extend(!0,{},c[this.id]);if(0===arguments.length)return r;if("string"==typeof t){var n=r[t];if(r.hasOwnProperty(t)&&0!==n.length)return n}},refresh:function(){var t=this;return i(t),e.each(u.refresh,function(){this.call(t)}),t}},Object.defineProperty(n,"extend",{configurable:!1,value:function(t){var r=e.extend(!0,{},t);r.hasOwnProperty("setup")&&(u.setup.push(r.setup),delete r.setup),r.hasOwnProperty("refresh")&&(u.refresh.push(r.refresh),delete r.refresh),e.each(r,function(e,t){return this.hasOwnProperty(e)?void console.error(s):void(n.prototype[e]=t)})}}),n.prototype.setup.prototype=n.prototype,t.TinyForm=n}(jQuery,window),function(e,t){"use strict";function r(e,t,r){if(0!==r.length)return r.is("[type=radio]")?void r.prop("checked",!1).filter("[value="+t+"]:first").prop("checked",!0):r.is("[type=checkbox]")?void r.prop("checked",!!t):void r.val(t)}function n(t){var r={};return e.each(t.getField(),function(e){r[e]=i(t,e)}),r}function i(e,t){var r=e.getField(t);return r.is("input")?a(r):r.val()}function a(e){return e.is("[type=radio]")?e.filter(":checked").val():e.is("[type=checkbox]")?e.is(":checked"):e.val()}var o={};t.extend({setup:function(){o[this.id]=this.getData()},getData:function(e){if(0===arguments.length)return n(this);if("string"==typeof e)return i(this,e)},setData:function(t,n){var i=this;return 0===arguments.length?(console.error("setData 需要至少1个参数"),i):arguments.length>=2?"string"!=typeof n?i:(r(i,t,i.getField(n)),i):(e.each(i.getField(),function(e,n){var a=t[e];"undefined"!=typeof a&&null!==a||(a=""),r(i,a,n)}),i)},submit:function(t){var r=this;return t=e.extend({url:r.context.attr("action"),type:r.context.attr("method")||"post",async:!0,data:r.getData(),cache:!1},t),e.isFunction(r.option.beforeSubmit)&&r.option.beforeSubmit.call(r,t),e.ajax(t),r},reset:function(){return e.isFunction(this.context.get(0).reset)?this.context.get(0).reset():this.setData(o[this.id]),this}})}(jQuery,TinyForm),function(e,t){"use strict";function r(t){var r=p[t.id]={};e.each(t.getField(),function(t,i){var a=e.trim(i.attr(c.rule)),s=i.attr(c.msg);return""===a?void(r[t]=!1):o.hasOwnProperty(a)?(r[t]=e.extend(!0,{},o[a]),void("undefined"!=typeof s&&(r[t].msg=s))):void(r[t]=n(a,s))})}function n(e,t){var r={};return!!e&&(0===e.indexOf("regex:")?(r.rule=new RegExp(e.replace("regex:","")),r.msg=t||"格式不正确",r):0===e.indexOf("length:")?i(e,t):(console.error(u+":"+e),!1))}function i(e,t){var r={},n=e.replace("length:","").split(",");if(1===n.length){var i=parseInt(n[0]);return isNaN(i)||i<0?(console.error(l+' "'+e+'"'),!1):(r.rule=new RegExp(s.least.rule.replace("{0}",i),"g"),r.msg=t||s.least.msg.replace("{0}",i),r)}if(2===n.length){var a=parseInt(n[0]),o=parseInt(n[1]);return(isNaN(a)||a<0||isNaN(o)||o<0)&&console.error(l+' "'+e+'"'),r.rule=new RegExp(s.between.rule.replace("{0}",a).replace("{1}",o),"g"),r.msg=t||s.between.msg.replace("{0}",a).replace("{1}",o),r}return console.error(u+":"+e),!1}function a(t,r){var n=t.getField(r);if(0===n.length)return!1;var i=t.getRule(r);if("undefined"==typeof i||i===!1)return!0;var a=t.getData(r),o=!i.rule||i.rule.test((a||"").toString().replace(/[\r\n]/g," ")),s=t.option.validate.callback;if(!e.isFunction(s))return o;var u=s.call(t,{pass:o,field:n,value:a,msg:i.msg});return"undefined"!=typeof u&&(o=!!u),o}var o={required:{rule:/^.+$/,msg:"不能为空"},number:{rule:/^[0-9]+$/,msg:"请输入数字"},alpha:{rule:/^[a-zA-Z]+$/,msg:"请输入字母"},email:{rule:/^(\w)+(\.\w+)*@(\w)+((\.\w+)+)$/,msg:"请输入有效的邮箱"},url:{rule:/^[0-9a-z]+(\.[0-9a-z\-_])*\.[\w]+$/i,msg:"请输入有效的网址"}},s={least:{rule:"^.{{0}}.*$",msg:"长度不能少于{0}个字"},equals:{rule:"^.{{0}}$",msg:"长度需要{0}个字"},between:{rule:"^.{{0},{1}}$",msg:"长度应该在{0}到{1}个字之间"}},u="不支持的验证规则",l="验证规则无效: 长度需要正整数",c={rule:"data-rule",msg:"data-msg"},p={};t.extend({setup:function(){var t=this;t.option.validate=e.extend(!0,{auto:!1,stop:!0,callback:function(){}},t.option.validate),r(this),t.option.validate.auto&&e.each(this.getField(),function(e){this.blur(function(){t.validate(e)})})},refresh:function(){r(this)},getRule:function(t){var r=e.extend(!0,{},p[this.id]);return 0===arguments.length?r:0===this.getField(t).length?{}:r[t]},validate:function(e){var t=this;if(arguments.length>0)return"string"==typeof e&&a(t,e);var r={pass:!0,detail:{}},n=t.getField();for(var i in n)if(n.hasOwnProperty(i)){var o=a(t,i);if(!o&&t.option.validate.stop)return!1;r.detail[i]=o,!o&&r.pass&&(r.pass=!1)}return r.pass||r.detail}})}(jQuery,TinyForm);